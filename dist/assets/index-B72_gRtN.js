var w=Object.defineProperty;var T=(t,e,r)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var h=(t,e,r)=>(T(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const L=[[0,0],[1,0],[2,0],[0,1],[1,1],[2,1],[0,2],[1,2],[2,2]],A=[[[0,0],[0,1],[0,2]],[[1,0],[1,1],[1,2]],[[2,0],[2,1],[2,2]],[[0,0],[1,0],[2,0]],[[0,1],[1,1],[2,1]],[[0,2],[1,2],[2,2]],[[0,0],[1,1],[2,2]],[[0,2],[1,1],[2,0]]],d=["#d5a021","#9627a7","#a72e30","#304CA0","#0C7500"];class G{constructor(){h(this,"board");h(this,"isPlaying");this.board=[[null,null,null],[null,null,null],[null,null,null]],this.isPlaying=!1}getIsPlaying(){return this.isPlaying}getBoardCopy(){return this.board.map(e=>[...e])}getPlayer(e){const r=e.flat(3),n=r.filter(i=>i==="X").length,o=r.filter(i=>i==="O").length;return n<=o?"X":"O"}getActions(e){return L.filter(n=>!e[n[0]][n[1]])}getValidity(e,r){return!e[r[0]][r[1]]}getResult(e,r){if(!this.getValidity(e,r))return console.error("Invalid action");let n=this.getBoardCopy(),o=this.getPlayer(e);return n[r[0]][r[1]]=o,n}getWinner(e){for(let r of A){let n=0,o=0;if(r.forEach(i=>{e[i[0]][i[1]]=="X"&&n++,e[i[0]][i[1]]=="O"&&o++}),n==3)return"X";if(o==3)return"O"}return null}getIfTerminal(e){if(this.getWinner(e))return!0;let r=0;return e.forEach(n=>{n.forEach(o=>{o&&r++})}),r==9}makeMove(e,r){let n=this.getResult(e,r);n&&this.setBoard(n)}setBoard(e){this.board=e}start(){this.isPlaying=!0}stop(){this.isPlaying=!1}initializeBoard(){this.board=[[null,null,null],[null,null,null],[null,null,null]]}}function V(t){let e=t.getBoardCopy();if(t.getIfTerminal(e))return null;const r=5;let n=0;if(t.getPlayer(e)==="X"){let[o,i]=b(t,e,r,n);return i}else if(t.getPlayer(e)==="O"){let[o,i]=I(t,e,r,n);return i}else return null}function b(t,e,r,n){if(t.getIfTerminal(e))return O(t,e);if(r==n)return[0,null];let o=-1/0,i=null,c=t.getActions(e);n+=1;for(let u of c){if(!t.getValidity(e,u))continue;let[g,E]=I(t,t.getResult(e,u),r,n);if(g>o&&(o=g,i=u),o===1)break}return[o,i]}function I(t,e,r,n){if(t.getIfTerminal(e))return O(t,e);if(r==n)return[0,null];let o=1/0,i=null,c=t.getActions(e);n+=1;for(let u of c){if(!t.getValidity(e,u))continue;let[g,E]=b(t,t.getResult(e,u),r,n);if(g<o&&(o=g,i=u),o===-1)break}return[o,i]}function O(t,e){let r=t.getWinner(e);return r==="X"?[1,null]:r==="O"?[-1,null]:[0,null]}const M=document.querySelector("#scoreO"),B=document.querySelector("#scoreX"),l=document.querySelector("#startX"),s=document.querySelector("#startO"),C=document.querySelector("#message"),x=document.querySelector(":root");let m=0,p=0;function P(t){let e=t.getBoardCopy();if(L.forEach((r,n)=>{let o=document.querySelector(`#elem${n}`);if(!o)return console.error("Unable to locate elem");let i=e[r[0]][r[1]];o.textContent=i||" "}),t.getIfTerminal(e)){let r=t.getWinner(e);t.stop(),k(),r=="X"?(p++,y("X wins!")):r=="O"?(m++,y("O wins!")):y("Tie!"),console.log(m,p)}M&&B&&(M.innerHTML=m.toString(),B.innerHTML=p.toString())}function X(t,e){if(!e.getIsPlaying())return console.error("Game not in progress");let r=L[t],n=e.getBoardCopy();e.getValidity(n,r)&&(e.makeMove(n,r),n=e.getBoardCopy(),P(e),setTimeout(()=>{q(e)},200))}function q(t){if(!t.getIsPlaying())return console.error("Game not in progress");let e=V(t);if(!e)return console.error("terminal board");let r=t.getBoardCopy();console.log("aiMove: ",e),t.makeMove(r,e),P(t)}function S(t,e){t.getIsPlaying()||(s==null||s.classList.add("opacity-0","cursor-default"),l==null||l.classList.add("opacity-0","cursor-default"),s==null||s.classList.remove("cursor-pointer"),l==null||l.classList.remove("cursor-pointer"),d&&x.style.setProperty("--main-color",d[Math.ceil(Math.random()*d.length-1)]),y("Game started"),t.initializeBoard(),P(t),t.start(),e=="O"&&q(t))}function k(){s==null||s.classList.remove("opacity-0","cursor-default"),l==null||l.classList.remove("opacity-0","cursor-default"),s==null||s.classList.add("cursor-pointer"),l==null||l.classList.add("cursor-pointer")}function R(t,e){if(!t)return y("Unable to locate gameboard");for(let r=0;r<9;r++){let n=document.createElement("div");n.id="elem"+r.toString(),n.classList.add("GBelem"),n.addEventListener("click",()=>{X(r,e)}),t.appendChild(n)}}function y(t){C&&(C.textContent=t)}const W=document.querySelector(":root"),_=document.querySelector("#gameboard"),a=document.querySelector("#startX"),f=document.querySelector("#startO");let v=new G;document.addEventListener("DOMContentLoaded",()=>{d&&W.style.setProperty("--main-color",d[Math.ceil(Math.random()*d.length-1)]),R(_,v),a==null||a.addEventListener("click",()=>S(v,"X")),f==null||f.addEventListener("click",()=>S(v,"O")),f==null||f.classList.add("cursor-pointer"),a==null||a.classList.add("cursor-pointer"),y("Choose wether to play as X or as O")});
